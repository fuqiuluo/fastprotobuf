package net.oicq

import kotlinx.serialization.encodeToString
import moe.fuqiuluo.proto2json.ProtoUtils
import moe.fuqiuluo.proto2json.hex2ByteArray
import moe.fuqiuluo.proto2json.toHexString

val pb2 = "0ae5030a7108b1aab28e051218755f30717a6346633756744f524e5a6e636162624f796e7718e90720edad92800228d0feea92064240088d989bcf02100118e6b802221be6b2a1e69c89e4babae6af94e68891e69bb4e68782e691b8e9b1bc280130013a0fe596b5e5919ce596b5e596b5e596b54808121e085220e8cef9f3052896ad19309eb0d3a706380160e8cef9f385808080011acf020acc020a210800109eb0d3a70618e8cef9f3052000280a300038860140024a06e5ae8be4bd93126daa026a08005000600068008001009a015c080b20cb5078808004c80100f00100f80100900200c802009803d302a00340b00301b80300c0038c9f01d00300e803008a0406080308011064900480c8808004b8048202c00400ca040408003007f804cc8408800555880514800600121eaa031b0821121508950212072fe6b1aae6b1aa1a072fe6b1aae6b1aa1801121eaa031b0821121508950212072fe6b1aae6b1aa1a072fe6b1aae6b1aa1801121eaa031b0821121508950212072fe6b1aae6b1aa1a072fe6b1aae6b1aa1801121eaa031b0821121508950212072fe6b1aae6b1aa1a072fe6b1aae6b1aa180112084a0608b9da7e4001122e82012b121be6b2a1e69c89e4babae6af94e68891e69bb4e68782e691b8e9b1bc1801200828033a06e5ba9fe789a93211080110011a0508031096012097b0d3a706".hex2ByteArray(true)

fun main() {
    println("PB大小: " + pb2.size)
    val obj = ProtoUtils.decodeFromByteArray(pb2)
    // 打印成json
    println(json.encodeToString(obj.toJson()))

    val enc = ProtoUtils.encodeToByteArray(obj)
    println(enc.toHexString())

    println(enc.contentEquals(pb2))
}